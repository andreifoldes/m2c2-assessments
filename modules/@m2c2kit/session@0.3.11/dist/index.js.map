{"version":3,"file":"index.js","sources":["../src/DomHelper.ts","../src/SessionEvent.ts","../src/m2c2kitCss.ts","../src/Session.ts","../src/index.ts"],"sourcesContent":["import { Activity, ActivityType } from \"@m2c2kit/core\";\n\nexport class DomHelper {\n  /**\n   * Specifies the HTML element in which to render the m2c2kit activities.\n   *\n   * @param rootElement - the element to add the survey div and canvas div to\n   */\n  static createRoot(rootElement: HTMLElement): void {\n    const surveyDiv = document.createElement(\"div\");\n    surveyDiv.setAttribute(\"id\", \"m2c2kit-survey-div\");\n    rootElement.appendChild(surveyDiv);\n\n    const canvasDiv = document.createElement(\"div\");\n    canvasDiv.setAttribute(\"id\", \"m2c2kit-canvas-div\");\n    canvasDiv.className = \"m2c2kit-full-viewport m2c2kit-flex-container\";\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.setAttribute(\"id\", \"m2c2kit-canvas\");\n    canvas.className = \"m2c2kit-full-viewport\";\n    canvasDiv.appendChild(canvas);\n\n    rootElement.appendChild(canvasDiv);\n  }\n\n  /**\n   * Adds a style sheet to the head of the document.\n   *\n   * @param css - text of the CSS\n   */\n  static addStyleSheet(css: string): void {\n    const styleSheet = document.createElement(\"style\");\n    styleSheet.innerText = css;\n    document.head.appendChild(styleSheet);\n  }\n\n  /**\n   * Add elements to hide the canvas and show a spinner.\n   */\n  static addLoadingElements(): void {\n    const canvasDiv = document.getElementById(\"m2c2kit-canvas-div\");\n    if (!canvasDiv) {\n      throw new Error(\"Could not find container element\");\n    }\n\n    let overlayDiv = document.getElementById(\"m2c2kit-canvas-overlay-div\");\n    if (!overlayDiv) {\n      overlayDiv = document.createElement(\"div\");\n      overlayDiv.setAttribute(\"id\", \"m2c2kit-canvas-overlay-div\");\n      overlayDiv.className = \"m2c2kit-canvas-overlay m2c2kit-display-none\";\n\n      const spinnerDiv = document.createElement(\"div\");\n      spinnerDiv.setAttribute(\"id\", \"m2c2kit-spinner-div\");\n      spinnerDiv.className = \"m2c2kit-spinner m2c2kit-display-none\";\n\n      canvasDiv.appendChild(overlayDiv);\n      canvasDiv.appendChild(spinnerDiv);\n    }\n  }\n\n  /**\n   * Depending on the type of activity, set the visibility of the survey div\n   * and canvas div.\n   *\n   * @param activity - the activity to configure the DOM for\n   */\n  static configureDomForActivity(activity: Activity): void {\n    if (activity.type == ActivityType.Game) {\n      this.setCanvasDivVisibility(true);\n      this.setSurveyDivVisibility(false);\n    }\n    if (activity.type == ActivityType.Survey) {\n      this.setCanvasDivVisibility(false);\n      this.setSurveyDivVisibility(true);\n      DomHelper.setBusyAnimationVisibility(false);\n      DomHelper.setCanvasOverlayVisibility(false);\n    }\n  }\n\n  /**\n   * Hide the canvas div and survey div.\n   */\n  static hideM2c2Elements(): void {\n    this.setCanvasDivVisibility(false);\n    this.setSurveyDivVisibility(false);\n  }\n\n  /**\n   * Shows or hides the canvas overlay.\n   *\n   * @param visible - true if the canvas overlay should be visible\n   */\n  static setCanvasOverlayVisibility(visible: boolean): void {\n    const div = document.getElementById(\"m2c2kit-canvas-overlay-div\");\n    if (div) {\n      if (visible) {\n        div.classList.remove(\"m2c2kit-display-none\");\n      } else {\n        div.classList.add(\"m2c2kit-display-none\");\n      }\n    }\n  }\n\n  /**\n   * Shows or hides the busy animation.\n   *\n   * @param visible - true if the busy animation should be visible\n   */\n  static setBusyAnimationVisibility(visible: boolean): void {\n    const div = document.getElementById(\"m2c2kit-spinner-div\");\n    if (div) {\n      if (visible) {\n        div.classList.remove(\"m2c2kit-display-none\");\n      } else {\n        div.classList.add(\"m2c2kit-display-none\");\n      }\n    }\n  }\n\n  /**\n   * Shows or hides the survey div.\n   *\n   * @param visible - true if the survey div should be visible\n   */\n  private static setSurveyDivVisibility(visible: boolean): void {\n    const surveyDiv = document.getElementById(\"m2c2kit-survey-div\");\n    if (surveyDiv && visible) {\n      surveyDiv.classList.remove(\"m2c2kit-display-none\");\n      surveyDiv.classList.add(\"m2c2kit-display-block\");\n    }\n    if (surveyDiv && !visible) {\n      surveyDiv.classList.add(\"m2c2kit-display-none\");\n      surveyDiv.classList.remove(\"m2c2kit-display-block\");\n    }\n  }\n\n  /**\n   * Shows or hides the canvas div.\n   *\n   * @param visible - true if the canvas div should be visible\n   */\n  private static setCanvasDivVisibility(visible: boolean): void {\n    const canvasDiv = document.getElementById(\"m2c2kit-canvas-div\");\n    if (canvasDiv && visible) {\n      canvasDiv.classList.remove(\"m2c2kit-display-none\");\n      canvasDiv.classList.add(\"m2c2kit-flex-container\");\n    }\n    if (canvasDiv && !visible) {\n      canvasDiv.classList.add(\"m2c2kit-display-none\");\n      canvasDiv.classList.remove(\"m2c2kit-flex-container\");\n    }\n  }\n}\n","import { M2Event } from \"@m2c2kit/core\";\nimport { Session } from \"./Session\";\n\n/** Base interface for all Session events. */\nexport interface SessionEvent extends M2Event<Session> {\n  target: Session;\n}\n\nexport const SessionEventType = {\n  SessionInitialize: \"SessionInitialize\",\n  SessionStart: \"SessionStart\",\n  SessionEnd: \"SessionEnd\",\n} as const;\n\nexport type SessionEventType =\n  (typeof SessionEventType)[keyof typeof SessionEventType];\n","export const m2c2kitCss = `.m2c2kit-background-color {\n  background: white;\n}\n\n.m2c2kit-no-margin {\n  margin: 0;\n}\n\n.m2c2kit-display-none {\n  display: none;\n}\n\n.m2c2kit-display-block {\n  display: block;\n}\n\n.m2c2kit-full-viewport {\n  height: 100vh;\n  width: 100vw;\n}\n\n.m2c2kit-flex-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.m2c2kit-canvas-overlay {\n  background-color: white;\n  width: 100vw;\n  height: 100vh;\n  position: absolute\n}\n\n.m2c2kit-spinner {\n  border: 16px solid #f3f3f3;\n  border-radius: 50%;\n  border-top: 16px solid #212529;\n  width: 120px;\n  height: 120px;\n  /* Safari */\n  -webkit-animation: m2c2kit-loader-spin 1.5s linear infinite;\n  animation: m2c2kit-loader-spin 1.5s linear infinite;\n  position: absolute;\n}\n\n#m2c2kit-time-stepping-div {\n  position: fixed;\n  top: 4px;\n  left: 4px\n}\n\n/* Safari */\n@-webkit-keyframes m2c2kit-loader-spin {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n\n@keyframes m2c2kit-loader-spin {\n  0% {\n    transform: rotate(0deg);\n  }\n\n  100% {\n    transform: rotate(360deg);\n  }\n}`;\n","import {\n  Activity,\n  ActivityEvent,\n  ActivityType,\n  ActivityLifecycleEvent,\n  ActivityResultsEvent,\n  CallbackOptions,\n  IDataStore,\n  Timer,\n  FontAsset,\n  Uuid,\n  M2EventType,\n  Constants,\n  M2EventListener,\n  Game,\n  M2c2KitHelpers,\n} from \"@m2c2kit/core\";\nimport { DomHelper } from \"./DomHelper\";\nimport { SessionOptions } from \"./SessionOptions\";\nimport { SessionLifecycleEvent } from \"./SessionLifecycleEvent\";\nimport { SessionEvent, SessionEventType } from \"./SessionEvent\";\nimport { m2c2kitCss } from \"./m2c2kitCss\";\n\nexport class Session {\n  options: SessionOptions;\n  currentActivity?: Activity;\n  private _uuid?: string;\n  dataStores?: IDataStore[];\n  private eventListeners = new Array<\n    M2EventListener<SessionEvent | ActivityEvent>\n  >();\n  private sessionDictionary = new Map<string, SessionDictionaryValues>();\n  private initialized = false;\n\n  /**\n   * A Session contains one or more activities. The session manages the start\n   * and stop of activities, and advancement to next activity\n   *\n   * @param options\n   */\n  constructor(options: SessionOptions) {\n    this.options = options;\n\n    // Make session also available on window in case we want to control or inspect it\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    (window as unknown as any).m2c2kitSession = this;\n\n    this.addDebuggingTools();\n  }\n\n  /**\n   * Adds debugging tools to the session.\n   *\n   * @remarks These tools can be added by appending query parameters to the\n   * URL or by setting game parameters via the Game.SetParameters() method.\n   */\n  private addDebuggingTools() {\n    if (/eruda=true/.test(window.location.href)) {\n      M2c2KitHelpers.loadEruda();\n    }\n\n    const urlParams = new URLSearchParams(window.location.search);\n    const scriptsParam = urlParams.get(\"scripts\");\n    if (scriptsParam) {\n      try {\n        const scripts = JSON.parse(\n          decodeURIComponent(scriptsParam),\n        ) as string[];\n        M2c2KitHelpers.loadScriptUrls(scripts);\n      } catch {\n        console.log(\n          `Error parsing \"scripts\" parameter. \"scripts\" must be an array of URL strings, and it is recommended to be URI encoded.`,\n        );\n      }\n    }\n  }\n\n  /**\n   * Executes a callback when the session initializes.\n   *\n   * @param callback - function to execute.\n   * @param options - options for the callback.\n   */\n  onInitialize(\n    callback: (sessionLifecycleEvent: SessionLifecycleEvent) => void,\n    options?: CallbackOptions,\n  ): void {\n    this.addEventListener(\n      SessionEventType.SessionInitialize,\n      callback,\n      options,\n    );\n  }\n\n  /**\n   * Executes a callback when the session starts.\n   *\n   * @param callback - function to execute.\n   * @param options - options for the callback.\n   */\n  onStart(\n    callback: (sessionLifecycleEvent: SessionLifecycleEvent) => void,\n    options?: CallbackOptions,\n  ): void {\n    this.addEventListener(SessionEventType.SessionStart, callback, options);\n  }\n\n  /**\n   * Executes a callback when the session ends.\n   *\n   * @param callback - function to execute.\n   * @param options - options for the callback.\n   */\n  onEnd(\n    callback: (sessionLifecycleEvent: SessionLifecycleEvent) => void,\n    options?: CallbackOptions,\n  ): void {\n    this.addEventListener(SessionEventType.SessionEnd, callback, options);\n  }\n\n  /**\n   * Executes a callback when any activity in the session generates data.\n   *\n   * @param callback - function to execute.\n   * @param options - options for the callback.\n   */\n  onActivityData(\n    callback: (activityResultsEvent: ActivityResultsEvent) => void,\n    options?: CallbackOptions,\n  ): void {\n    this.addEventListener(M2EventType.ActivityData, callback, options);\n  }\n\n  private addEventListener<T extends SessionEvent | ActivityEvent>(\n    type: M2EventType | SessionEventType,\n    callback: (ev: T) => void,\n    options?: CallbackOptions,\n  ): void {\n    const eventListener: M2EventListener<T> = {\n      type: type,\n      callback: callback,\n      key: options?.key,\n    };\n\n    if (options?.replaceExisting) {\n      this.eventListeners = this.eventListeners.filter(\n        (listener) => !(listener.type === eventListener.type),\n      );\n    }\n    this.eventListeners.push(\n      eventListener as M2EventListener<SessionEvent | ActivityEvent>,\n    );\n  }\n\n  private raiseEventOnListeners(\n    event: SessionEvent | ActivityEvent,\n    extra?: unknown,\n  ): void {\n    if (extra) {\n      event = {\n        ...event,\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        ...(extra as any),\n      };\n    }\n    this.eventListeners\n      .filter((listener) => listener.type === event.type)\n      .forEach((listener) => {\n        listener.callback(event);\n      });\n  }\n\n  private async sessionActivityStartHandler(event: ActivityLifecycleEvent) {\n    const activityType =\n      event.target.type === ActivityType.Game ? \"game\" : \"survey\";\n    console.log(`ðŸŸ¢ started activity (${activityType}) ${event.target.name}`);\n  }\n\n  private async sessionActivityCancelHandler(event: ActivityLifecycleEvent) {\n    const activityType =\n      event.target.type === ActivityType.Game ? \"game\" : \"survey\";\n    console.log(`ðŸš« canceled activity (${activityType}) ${event.target.name}`);\n\n    if (this.nextActivity && this.options.autoGoToNextActivity !== false) {\n      await this.goToNextActivity();\n      // Note: important to return here, because now this.nextActivity refers\n      // to the activity AFTER the one we have just advanced to.\n      return;\n    }\n    if (!this.nextActivity && this.options.autoEndAfterLastActivity !== false) {\n      this.end();\n    }\n  }\n\n  private async sessionActivityEndHandler(event: ActivityLifecycleEvent) {\n    const activityType =\n      event.target.type === ActivityType.Game ? \"game\" : \"survey\";\n    console.log(`ðŸ”´ ended activity (${activityType}) ${event.target.name}`);\n    if (this.nextActivity && this.options.autoGoToNextActivity !== false) {\n      await this.goToNextActivity();\n      // Note: important to return here, because now this.nextActivity refers\n      // to the activity AFTER the one we have just advanced to.\n      return;\n    }\n    if (!this.nextActivity && this.options.autoEndAfterLastActivity !== false) {\n      this.end();\n    }\n  }\n\n  private async sessionActivityLifecycleHandler(event: ActivityLifecycleEvent) {\n    if (event.type === M2EventType.ActivityStart) {\n      await this.sessionActivityStartHandler(event);\n      return;\n    }\n\n    if (event.type === M2EventType.ActivityCancel) {\n      await this.sessionActivityCancelHandler(event);\n      return;\n    }\n\n    if (event.type === M2EventType.ActivityEnd) {\n      await this.sessionActivityEndHandler(event);\n      return;\n    }\n\n    throw new Error(\"unknown activity lifecycle event type\");\n  }\n\n  private activityResultsEventHandler(event: ActivityResultsEvent) {\n    this.raiseEventOnListeners(event);\n  }\n\n  /**\n   * Asynchronously initializes the m2c2kit engine and loads assets\n   *\n   * @deprecated Use Session.initialize() instead.\n   */\n  async init(): Promise<void> {\n    console.warn(\n      `The init() method of Session is deprecated. Use initialize() instead.`,\n    );\n    return this.initialize();\n  }\n\n  /**\n   * Check if the Activity uses the deprecated init() method.\n   *\n   * @remarks Activity.init() is deprecated and should be replaced with\n   * Activity.initialize().\n   *\n   * @param activity\n   * @returns true if the activity defines its own init() method, false otherwise.\n   */\n  private activityUsesDeprecatedInit(activity: Activity): boolean {\n    if (activity.type === ActivityType.Survey) {\n      return false;\n    }\n    const activityPrototype = Object.getPrototypeOf(activity);\n    const gamePrototype = Object.getPrototypeOf(activityPrototype);\n    return activityPrototype?.init !== gamePrototype?.init;\n  }\n\n  /**\n   * Asynchronously initializes the m2c2kit engine and loads assets\n   */\n  async initialize(): Promise<void> {\n    Timer.startNew(\"sessionInitialize\");\n\n    if (this.options.sessionUuid) {\n      this.uuid = this.options.sessionUuid;\n    } else {\n      this.uuid = Uuid.generate();\n    }\n\n    for (const activity of this.options.activities) {\n      if (this.options.activities.filter((a) => a === activity).length > 1) {\n        throw new Error(\n          `error in SessionOptions.activities: an instance of the activity named \"${activity.name}\" has been added more than once to the session. If you want to repeat the same activity, create separate instances of it.`,\n        );\n      }\n      activity.sessionUuid = this.uuid;\n      if (this.options.activityCallbacks?.onActivityLifecycle) {\n        activity.onStart(this.options.activityCallbacks.onActivityLifecycle);\n        activity.onCancel(this.options.activityCallbacks.onActivityLifecycle);\n        activity.onEnd(this.options.activityCallbacks.onActivityLifecycle);\n      }\n      if (this.options.activityCallbacks?.onActivityResults) {\n        activity.onData(this.options.activityCallbacks.onActivityResults);\n      }\n\n      if (activity.type === ActivityType.Game) {\n        const game = activity as Game;\n        game.onWarmupStart(() => {\n          DomHelper.setCanvasOverlayVisibility(true);\n        });\n        game.onWarmupEnd(() => {\n          DomHelper.setCanvasOverlayVisibility(false);\n          DomHelper.setBusyAnimationVisibility(false);\n        });\n      }\n    }\n\n    const sessionInitializeEvent: SessionEvent = {\n      target: this,\n      type: SessionEventType.SessionInitialize,\n      ...M2c2KitHelpers.createTimestamps(),\n    };\n    this.raiseEventOnListeners(sessionInitializeEvent);\n    const rootId =\n      this.options.rootElementId ?? Constants.DEFAULT_ROOT_ELEMENT_ID;\n    const root = document.getElementById(rootId);\n    if (!root) {\n      throw new Error(\n        `Session.initialize(): root element with id ${rootId} not found. The index.html should have: <div id=\"${rootId}\"></div>.`,\n      );\n    }\n    DomHelper.createRoot(root);\n    DomHelper.addStyleSheet(this.options.styleSheet ?? m2c2kitCss);\n    DomHelper.addLoadingElements();\n    DomHelper.setBusyAnimationVisibility(true);\n    DomHelper.setCanvasOverlayVisibility(true);\n\n    this.dataStores = this.options.dataStores;\n    if (this.dataStores?.length === 0) {\n      throw new Error(\n        \"Session.initialize(): dataStores must be undefined or a non-zero array of datastores.\",\n      );\n    }\n\n    await this.getSharedAssets(this.options.activities);\n\n    await Promise.all(\n      this.options.activities.map((activity) => {\n        activity.studyId = this.options.studyId;\n        activity.studyUuid = this.options.studyUuid;\n        // IDataStore implementation is provided by another library and must\n        // be set in the session before calling session.initialize()\n        activity.dataStores = this.dataStores;\n        activity.onStart(this.sessionActivityLifecycleHandler.bind(this));\n        activity.onCancel(this.sessionActivityLifecycleHandler.bind(this));\n        activity.onEnd(this.sessionActivityLifecycleHandler.bind(this));\n        activity.onData((event: ActivityResultsEvent) => {\n          this.activityResultsEventHandler(event);\n        });\n\n        if (this.activityUsesDeprecatedInit(activity)) {\n          console.warn(\n            `game ${activity.id}: Activity.init() is deprecated. In the assessment class that extends Game, use Activity.initialize() instead:\\n  async initialize() {\\n    await super.initialize();\\n    ...\\n  }\\n`,\n          );\n          return activity.init();\n        }\n        return activity.initialize();\n      }),\n    );\n\n    console.log(\n      `âšª Session.initialize() took ${Timer.elapsed(\n        \"sessionInitialize\",\n      ).toFixed(0)} ms`,\n    );\n    Timer.remove(\"sessionInitialize\");\n    this.initialized = true;\n    if (this.options.autoStartAfterInit !== false) {\n      await this.start();\n    }\n  }\n\n  /**\n   * Asynchronously loads fonts and wasm binaries that are common across two\n   * or more game activities and shares them with the games.\n   *\n   * @param activities - array of activities\n   */\n  private async getSharedAssets(activities: Activity[]) {\n    const games = activities.filter(\n      (activity) =>\n        activity.type === ActivityType.Game &&\n        (activity as Game).options.shareAssets !== false,\n    ) as Array<Game>;\n\n    if (games.length > 0) {\n      const manifest = await games[0].loadManifest();\n      games.forEach((game) => {\n        game.manifest = manifest;\n      });\n\n      const wasmPromises = this.initializeSharedCanvasKit(games);\n      const fontPromises = this.fetchSharedFontData(games);\n      await Promise.all([...wasmPromises, ...fontPromises]);\n    }\n  }\n\n  private initializeSharedCanvasKit(games: Game[]) {\n    const sharedWasmVersions = this.getDuplicates(\n      games.map((game) => game.canvasKitWasmVersion),\n    );\n    const wasmAssets = games.map((game) => {\n      return {\n        game: game,\n        version: game.canvasKitWasmVersion,\n        data: undefined,\n      };\n    });\n\n    const wasmPromises = sharedWasmVersions.map(async (sharedWasmVersion) => {\n      const wasmAsset = wasmAssets.filter(\n        (wasm) => wasm.version === sharedWasmVersion,\n      )[0];\n      const game = wasmAsset.game;\n      const baseUrls = await game.resolveGameBaseUrls(game);\n      const canvasKitWasmFilename = `canvaskit-${game.canvasKitWasmVersion}.wasm`;\n      const manifestCanvasKitWasmUrl = M2c2KitHelpers.getUrlFromManifest(\n        game,\n        `${baseUrls.canvasKitWasm}/${canvasKitWasmFilename}`,\n      );\n      console.log(`âšª sharing ${canvasKitWasmFilename} within session`);\n\n      const canvasKit = await game.loadCanvasKit(manifestCanvasKitWasmUrl);\n      games.forEach((game) => {\n        if (game.canvasKitWasmVersion === sharedWasmVersion) {\n          game.canvasKit = canvasKit;\n        }\n      });\n    });\n    return wasmPromises;\n  }\n\n  private fetchSharedFontData(games: Game[]) {\n    const fontFiles = games\n      .flatMap(\n        (game) => game.options.fonts?.filter((f) => f.lazy !== true) ?? [],\n      )\n      .map((fontAsset) => this.getFilenameFromUrl(fontAsset.url));\n    const sharedFontFiles = this.getDuplicates(fontFiles);\n\n    const allGameFonts: Array<GameFontAsset> = games.flatMap((game) => {\n      return (game.options.fonts ?? []).map((fontAsset) => {\n        return {\n          game: game,\n          fontAsset: fontAsset,\n          filename: this.getFilenameFromUrl(fontAsset.url),\n          data: undefined,\n        };\n      });\n    });\n\n    const fontPromises = sharedFontFiles.map(async (sharedFontFile) => {\n      const gameFontAsset = allGameFonts.filter(\n        (gameFont) => gameFont.filename === sharedFontFile,\n      )[0];\n      const game = gameFontAsset.game;\n      const baseUrls = await game.resolveGameBaseUrls(game);\n      const fontUrl = M2c2KitHelpers.getUrlFromManifest(\n        game,\n        `${baseUrls.assets}/${gameFontAsset.fontAsset.url}`,\n      );\n      console.log(\n        `âšª sharing ${this.getFilenameFromUrl(fontUrl)} within session`,\n      );\n\n      const response = await fetch(fontUrl);\n      const fontData = await response.arrayBuffer();\n      games\n        .flatMap((game) => game.options.fonts ?? [])\n        .forEach((fontAsset) => {\n          if (this.getFilenameFromUrl(fontAsset.url) === sharedFontFile) {\n            fontAsset.sharedFont = {\n              url: fontUrl,\n              data: fontData,\n            };\n          }\n        });\n    });\n    return fontPromises;\n  }\n\n  /**\n   * Waits for the session to be initialized.\n   *\n   * @remarks Session.initialize() is asynchronous, and it should be awaited\n   * so that the session is fully initialized before calling Session.start().\n   * If it is not awaited (or it cannot be awaited because the target\n   * environment does not support top-level await), this function ensures that\n   * the session has been initialized.\n   */\n  private async waitForSessionInitialization(): Promise<void> {\n    while (!this.initialized) {\n      await new Promise((resolve) =>\n        setTimeout(\n          resolve,\n          Constants.SESSION_INITIALIZATION_POLLING_INTERVAL_MS,\n        ),\n      );\n    }\n  }\n\n  /**\n   * Starts the session and starts the first activity.\n   */\n  async start(): Promise<void> {\n    await this.waitForSessionInitialization();\n    console.log(\"ðŸŸ¢ started session\");\n    const sessionStartEvent: SessionLifecycleEvent = {\n      target: this,\n      type: SessionEventType.SessionStart,\n      ...M2c2KitHelpers.createTimestamps(),\n    };\n    this.raiseEventOnListeners(sessionStartEvent);\n    this.currentActivity = this.options.activities.find(Boolean);\n    if (this.currentActivity) {\n      DomHelper.configureDomForActivity(this.currentActivity);\n      await this.currentActivity.start();\n    } else {\n      // no activities, so immediately end the session\n      console.warn(\"no activities in session.\");\n      this.end();\n    }\n  }\n\n  /**\n   * Declares the session ended and sends callback.\n   */\n  end(): void {\n    console.log(\"ðŸ”´ ended session\");\n    DomHelper.hideM2c2Elements();\n    this.stop();\n    const sessionEndEvent: SessionLifecycleEvent = {\n      target: this,\n      type: SessionEventType.SessionEnd,\n      ...M2c2KitHelpers.createTimestamps(),\n    };\n    this.raiseEventOnListeners(sessionEndEvent);\n  }\n\n  private stop(): void {\n    this.dispose();\n  }\n\n  /**\n   * Frees up resources that were allocated to run the session.\n   *\n   * @remarks This will be done automatically by the m2c2kit library;\n   * the end-user must not call this.\n   */\n  private dispose(): void {\n    // TODO: Are there are any other resources that need to be disposed at the session level?\n  }\n\n  /**\n   * Stops the current activity and goes to the activity with the provided id.\n   *\n   * @param options\n   */\n  async goToActivity(options: GoToActivityOptions): Promise<void> {\n    const nextActivity = this.options.activities\n      .filter((activity) => activity.id === options.id)\n      .find(Boolean);\n    if (!nextActivity) {\n      throw new Error(\n        `Error in goToActivity(): Session does not contain an activity with id ${options.id}.`,\n      );\n    }\n    if (this.currentActivity) {\n      this.currentActivity.stop();\n    }\n\n    /**\n     * From this point on, the phrase \"currentActivity\" refers to the activity\n     * that we are going to, not the one we are leaving.\n     * currentActivityOldObject is an instance of the activity that has been\n     * fully initialized previously. We use currentActivityOldObject as a\n     * blueprint to create a new instance.\n     */\n    const currentActivityOldObject = nextActivity;\n\n    /**\n     * It is possible the current activity is one we have executed before. In\n     * that case, we need to reset everything about this activity. The cleanest\n     * way to do that is create a new instance of it. The below factory\n     * function does that.\n     * see https://stackoverflow.com/a/14378462\n     */\n    const activityFactoryFunction =\n      currentActivityOldObject.constructor.bind.apply(\n        currentActivityOldObject.constructor,\n        [null],\n      );\n    this.currentActivity = new activityFactoryFunction() as Activity;\n\n    const indexOfCurrentActivity = this.options.activities.indexOf(\n      currentActivityOldObject,\n    );\n    this.options.activities[indexOfCurrentActivity] = this.currentActivity;\n    DomHelper.configureDomForActivity(this.currentActivity);\n\n    /**\n     * Because the current activity has been newly created, it needs properties\n     * assigned to it that it would have received in the Session.initialize()\n     * method. Also, if the old instance had new parameters set via\n     * Game.SetParameters(), we must apply them.\n     */\n    this.currentActivity.dataStores = this.dataStores;\n    /**\n     * IMPORTANT: Originally, we checked if the current activity was a game\n     * by checking if it was an instance of Game. However, if we are mixing\n     * code bundles, the Game class in one bundle will not be the same as the\n     * Game class in another bundle. Instead, we must check the type property\n     * of the activity.\n     */\n    // if (this.currentActivity.type === ActivityType.Game && this.canvasKit) {\n    //   (this.currentActivity as Game).canvasKit = this.canvasKit;\n    // }\n    if (currentActivityOldObject.additionalParameters) {\n      this.currentActivity.setParameters(\n        currentActivityOldObject.additionalParameters,\n      );\n    }\n\n    /**\n     * In Session.initialize(), async assets were loaded. Once processed, they were\n     * stored in a dictionary, with the activity uuid as the key. When a new\n     * instance of the activity is created, the object has a different uuid.\n     * We must update the uuid in the dictionaries (if it exists).\n     */\n    // if (this.imageManager.loadedImages[currentActivityOldObject.uuid]) {\n    //   this.imageManager.loadedImages[this.currentActivity.uuid] =\n    //     this.imageManager.loadedImages[currentActivityOldObject.uuid];\n    //   delete this.imageManager.loadedImages[currentActivityOldObject.uuid];\n    // }\n    // if (this.fontManager.gameTypefaces[currentActivityOldObject.uuid]) {\n    //   this.fontManager.gameTypefaces[this.currentActivity.uuid] =\n    //     this.fontManager.gameTypefaces[currentActivityOldObject.uuid];\n    //   delete this.fontManager.gameTypefaces[currentActivityOldObject.uuid];\n    // }\n\n    await this.currentActivity.initialize();\n    await this.currentActivity.start();\n  }\n\n  /**\n   * Stops the current activity and advances to next activity in the session.\n   * If there is no activity after the current activity, throws error.\n   */\n  async goToNextActivity(): Promise<void> {\n    if (!this.currentActivity) {\n      throw new Error(\"error in advanceToNextActivity(): no current activity\");\n    }\n    if (!this.nextActivity) {\n      throw new Error(\"error in advanceToNextActivity(): no next activity\");\n    }\n    this.currentActivity.stop();\n    this.currentActivity = this.nextActivity;\n\n    DomHelper.configureDomForActivity(this.currentActivity);\n    await this.currentActivity.start();\n  }\n\n  /**\n   * Stops the current activity and advances to next activity in the session.\n   * If there is no activity after the current activity, throws error.\n   *\n   * @deprecated Use goToNextActivity() instead.\n   */\n  async advanceToNextActivity(): Promise<void> {\n    await this.goToNextActivity();\n  }\n\n  /**\n   * Gets the next activity after the current one, or undefined if\n   * this is the last activity.\n   */\n  get nextActivity(): Activity | undefined {\n    if (!this.currentActivity) {\n      throw new Error(\"error in get nextActivity(): no current activity\");\n    }\n    const index = this.options.activities.indexOf(this.currentActivity);\n    if (index === this.options.activities.length - 1) {\n      return undefined;\n    }\n    const currentActivityIndex = this.options.activities.indexOf(\n      this.currentActivity,\n    );\n    return this.options.activities[currentActivityIndex + 1];\n  }\n\n  /**\n   * Saves an item to the session's key-value dictionary.\n   *\n   * @remarks The session dictionary is not persisted. It is available only\n   * during the actively running session. It is useful for storing temporary\n   * data to coordinate between activities.\n   *\n   * @param key - item key\n   * @param value - item value\n   */\n  dictionarySetItem(key: string, value: SessionDictionaryValues): void {\n    this.sessionDictionary.set(key, value);\n  }\n\n  /**\n   * Gets an item value from the session's key-value dictionary.\n   *\n   * @remarks The session dictionary is not persisted. It is available only\n   * during the actively running session. It is useful for storing temporary\n   * data to coordinate between activities.\n   *\n   * @param key - item key\n   * @returns value of the item\n   */\n  dictionaryGetItem<T extends SessionDictionaryValues>(key: string) {\n    return this.sessionDictionary.get(key) as T;\n  }\n\n  /**\n   * Deletes an item value from the session's key-value dictionary.\n   *\n   * @remarks The session dictionary is not persisted. It is available only\n   * during the actively running session. It is useful for storing temporary\n   * data to coordinate between activities.\n   *\n   * @param key - item key\n   * @returns true if the item was deleted, false if it did not exist\n   */\n  dictionaryDeleteItem(key: string) {\n    return this.sessionDictionary.delete(key);\n  }\n\n  /**\n   * Determines if a key exists in the activity's key-value dictionary.\n   *\n   * @remarks The session dictionary is not persisted. It is available only\n   * during the actively running session. It is useful for storing temporary\n   * data to coordinate between activities.\n   *\n   * @param key - item key\n   * @returns true if the key exists, false otherwise\n   */\n  dictionaryItemExists(key: string) {\n    return this.sessionDictionary.has(key);\n  }\n\n  /**\n   * Returns the filename from a url.\n   *\n   * @param url - url to parse\n   * @returns filename\n   */\n  private getFilenameFromUrl(url: string) {\n    return url.substring(url.lastIndexOf(\"/\") + 1);\n  }\n\n  /**\n   * Returns the duplicated strings in an array.\n   *\n   * @param s - array of strings\n   * @returns array of duplicated strings\n   */\n  private getDuplicates(s: string[]): string[] {\n    const count: { [key: string]: number } = {};\n    const duplicates: string[] = [];\n\n    for (const str of s) {\n      count[str] = (count[str] || 0) + 1;\n      if (count[str] === 2) {\n        duplicates.push(str);\n      }\n    }\n\n    return duplicates;\n  }\n\n  get uuid(): string {\n    if (!this._uuid) {\n      throw new Error(\"Session.uuid is undefined.\");\n    }\n    return this._uuid;\n  }\n  set uuid(value: string) {\n    this._uuid = value;\n  }\n}\n\nexport interface GoToActivityOptions {\n  /** ActivityId of the activity to go to. */\n  id: string;\n}\n\n/**\n * Types of values that can be stored in the session dictionary.\n */\nexport type SessionDictionaryValues =\n  | string\n  | number\n  | boolean\n  | object\n  | null\n  | undefined;\n\ninterface GameFontAsset {\n  game: Game;\n  fontAsset: FontAsset;\n  filename: string;\n  data: ArrayBuffer | undefined;\n}\n","export * from \"./Session\";\nexport * from \"./SessionEvent\";\nexport * from \"./SessionOptions\";\nexport * from \"./SessionLifecycleEvent\";\nexport * from \"./DomHelper\";\n\nconsole.log(\"âšª @m2c2kit/session version __PACKAGE_JSON_VERSION__\");\n"],"names":["game"],"mappings":"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"}