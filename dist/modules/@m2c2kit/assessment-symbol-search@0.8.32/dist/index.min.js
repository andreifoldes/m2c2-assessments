import{Game as ae,WebColors as b,RandomDraws as v,Sprite as D,Scene as W,Transition as J,Easings as G,TransitionDirection as H,M2Error as F,Shape as Z,Label as L,Timer as z,Action as q}from"@m2c2kit/core";import{LocalePicker as le,Instructions as K,CountdownScene as ue,Grid as $,Button as ce}from"@m2c2kit/addons";class g extends Error{constructor(...e){super(...e),this.name="M2Error",Object.setPrototypeOf(this,g.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,g)}}class _{constructor(e,i){if(this._groups=new Array,!Array.isArray(e))throw new g("DataCalc constructor expects an array of observations as first argument");for(let n=0;n<e.length;n++)if(e[n]===null||typeof e[n]!="object"||Array.isArray(e[n]))throw new g(`DataCalc constructor expects all elements to be objects (observations). Element at index ${n} is ${typeof e[n]}. Element: ${JSON.stringify(e[n])}`);this._observations=this.deepCopy(e);const r=new Set;for(const n of e)for(const t of Object.keys(n))r.add(t);for(const n of this._observations)for(const t of r)t in n||(n[t]=null);i?.groups&&(this._groups=Array.from(i.groups))}get groups(){return this._groups}get observations(){return this._observations}get rows(){return this._observations}pull(e){if(this._observations.length===0)return console.warn(`DataCalc.pull(): No observations available to pull variable "${e}" from. Returning null.`),null;this.verifyObservationsContainVariable(e);const i=this._observations.map(r=>r[e]);return i.length===1?i[0]:i}get length(){return this._observations.length}filter(e){if(this._groups.length>0)throw new g(`filter() cannot be used on grouped data. The data are currently grouped by ${this._groups.join(", ")}. Ungroup the data first using ungroup().`);return new _(this._observations.filter(e),{groups:this._groups})}groupBy(...e){return e.forEach(i=>{this.verifyObservationsContainVariable(i)}),new _(this._observations,{groups:e})}ungroup(){return new _(this._observations)}mutate(e){if(this._groups.length>0)throw new g(`mutate() cannot be used on grouped data. The data are currently grouped by ${this._groups.join(", ")}. Ungroup the data first using ungroup().`);const i=this._observations.map(r=>{let n={...r};for(const[t,s]of Object.entries(e))n={...n,[t]:s(r)};return n});return new _(i,{groups:this._groups})}summarize(e){if(this._groups.length===0){const i={};for(const[r,n]of Object.entries(e))if(typeof n=="object"&&n!==null&&"summarizeFunction"in n){const t=n;i[r]=t.summarizeFunction(this,t.parameters,t.options)}else i[r]=n;return new _([i],{groups:this._groups})}return this.summarizeByGroups(e)}summarizeByGroups(e){const i=new Map;this._observations.forEach(n=>{const t=this._groups.map(o=>typeof n[o]=="object"?JSON.stringify(n[o]):n[o]).join("|");i.has(t)||i.set(t,[]);const s=i.get(t);s?s.push(n):i.set(t,[n])});const r=[];return i.forEach((n,t)=>{const s=t.split("|"),o=n[0],a={};this._groups.forEach((c,d)=>{const h=s[d],B=typeof o[c];if(B==="number")a[c]=Number(h);else if(B==="boolean")a[c]=h==="true";else if(h.startsWith("{")||h.startsWith("["))try{a[c]=JSON.parse(h)}catch{throw new g(`Failed to parse group value ${h} as JSON for group ${c}`)}else a[c]=h});const l=new _(n);for(const[c,d]of Object.entries(e))if(typeof d=="object"&&d!==null&&"summarizeFunction"in d){const h=d;a[c]=h.summarizeFunction(l,h.parameters,h.options)}else a[c]=d;r.push(a)}),new _(r,{groups:this._groups})}select(...e){const i=[],r=[];e.forEach(o=>{o.startsWith("-")?r.push(o.substring(1)):i.push(o)}),[...i.length>0?i:Object.keys(this._observations[0]||{}),...r].forEach(o=>{this.verifyObservationsContainVariable(o)});const t=new Set(r),s=this._observations.map(o=>{const a={};return i.length>0?i.forEach(l=>{t.has(l)||(a[l]=o[l])}):Object.keys(o).forEach(l=>{t.has(l)||(a[l]=o[l])}),a});return new _(s,{groups:this._groups})}arrange(...e){if(this._groups.length>0)throw new g(`arrange() cannot be used on grouped data. The data are currently grouped by ${this._groups.join(", ")}. Ungroup the data first using ungroup().`);const i=[...this._observations].sort((r,n)=>{for(const t of e){let s=t,o=1;if(t.startsWith("-")&&(s=t.substring(1),o=-1),!(s in r)||!(s in n))throw new g(`arrange(): variable ${s} does not exist in all observations`);const a=r[s],l=n[s];if(typeof a!=typeof l)return o*(String(a)<String(l)?-1:1);if(a<l)return-1*o;if(a>l)return 1*o}return 0});return new _(i,{groups:this._groups})}distinct(){const e=new Set,i=this._observations.filter(r=>{const n=JSON.stringify(this.normalizeForComparison(r));return e.has(n)?!1:(e.add(n),!0)});return new _(i,{groups:this._groups})}rename(e){if(this._observations.length===0)throw new g("Cannot rename variables on an empty dataset");Object.values(e).forEach(r=>{this.verifyObservationsContainVariable(r)});const i=this._observations.map(r=>{const n={};for(const[t,s]of Object.entries(r)){const o=Object.entries(e).find(([,a])=>a===t)?.[0];o?n[o]=s:Object.values(e).includes(t)||(n[t]=s)}return n});return new _(i,{groups:this._groups})}innerJoin(e,i){if(this._groups.length>0||e._groups.length>0)throw new g("innerJoin() cannot be used on grouped data. Ungroup the data first using ungroup().");i.forEach(t=>{this.verifyObservationsContainVariable(t),e.verifyObservationsContainVariable(t)});const r=new Map;e.observations.forEach(t=>{if(this.hasNullJoinKeys(t,i))return;const s=i.map(a=>JSON.stringify(this.normalizeForComparison(t[a]))).join("|"),o=r.get(s)||[];o.push(t),r.set(s,o)});const n=[];return this._observations.forEach(t=>{if(this.hasNullJoinKeys(t,i))return;const s=i.map(a=>JSON.stringify(this.normalizeForComparison(t[a]))).join("|"),o=r.get(s)||[];o.length>0&&o.forEach(a=>{const l={...t};Object.entries(a).forEach(([c,d])=>{i.includes(c)||(l[c]=d)}),n.push(l)})}),new _(n)}leftJoin(e,i){if(this._groups.length>0||e._groups.length>0)throw new g("leftJoin() cannot be used on grouped data. Ungroup the data first using ungroup().");i.forEach(t=>{this.verifyObservationsContainVariable(t),e.verifyObservationsContainVariable(t)});const r=new Map;e.observations.forEach(t=>{if(this.hasNullJoinKeys(t,i))return;const s=i.map(a=>JSON.stringify(this.normalizeForComparison(t[a]))).join("|"),o=r.get(s)||[];o.push(t),r.set(s,o)});const n=[];return this._observations.forEach(t=>{if(this.hasNullJoinKeys(t,i)){n.push({...t});return}const s=i.map(a=>JSON.stringify(this.normalizeForComparison(t[a]))).join("|"),o=r.get(s)||[];o.length>0?o.forEach(a=>{const l={...t};Object.entries(a).forEach(([c,d])=>{i.includes(c)||(l[c]=d)}),n.push(l)}):n.push({...t})}),new _(n)}rightJoin(e,i){if(this._groups.length>0||e._groups.length>0)throw new g("rightJoin() cannot be used on grouped data. Ungroup the data first using ungroup().");i.forEach(s=>{this.verifyObservationsContainVariable(s),e.verifyObservationsContainVariable(s)});const r=new Map;e.observations.forEach(s=>{if(this.hasNullJoinKeys(s,i))return;const o=i.map(l=>JSON.stringify(this.normalizeForComparison(s[l]))).join("|"),a=r.get(o)||[];a.push(s),r.set(o,a)});const n=[],t=new Set;return this._observations.forEach(s=>{if(this.hasNullJoinKeys(s,i))return;const o=i.map(l=>JSON.stringify(this.normalizeForComparison(s[l]))).join("|"),a=r.get(o)||[];a.length>0&&(a.forEach(l=>{const c={...s};Object.entries(l).forEach(([d,h])=>{i.includes(d)||(c[d]=h)}),n.push(c)}),t.add(o))}),e.observations.forEach(s=>{if(this.hasNullJoinKeys(s,i)){n.push({...s});return}const o=i.map(a=>JSON.stringify(this.normalizeForComparison(s[a]))).join("|");t.has(o)||(n.push({...s}),t.add(o))}),new _(n)}fullJoin(e,i){if(this._groups.length>0||e._groups.length>0)throw new g("fullJoin() cannot be used on grouped data. Ungroup the data first using ungroup().");i.forEach(s=>{this.verifyObservationsContainVariable(s),e.verifyObservationsContainVariable(s)});const r=new Map;e.observations.forEach(s=>{if(this.hasNullJoinKeys(s,i))return;const o=i.map(l=>JSON.stringify(this.normalizeForComparison(s[l]))).join("|"),a=r.get(o)||[];a.push(s),r.set(o,a)});const n=[],t=new Set;return this._observations.forEach(s=>{if(this.hasNullJoinKeys(s,i)){n.push({...s});return}const o=i.map(l=>JSON.stringify(this.normalizeForComparison(s[l]))).join("|"),a=r.get(o)||[];a.length>0?(a.forEach(l=>{const c={...s};Object.entries(l).forEach(([d,h])=>{i.includes(d)||(c[d]=h)}),n.push(c)}),t.add(o)):n.push({...s})}),e.observations.forEach(s=>{if(this.hasNullJoinKeys(s,i)){n.push({...s});return}const o=i.map(a=>JSON.stringify(this.normalizeForComparison(s[a]))).join("|");t.has(o)||(n.push({...s}),t.add(o))}),new _(n)}slice(e,i){if(this._groups.length>0)throw new g("slice() cannot be used on grouped data. Ungroup the data first using ungroup().");let r;if(e>=this._observations.length)return new _([],{groups:this._groups});if(i===void 0){const n=e<0?this._observations.length+e:e;r=[this._observations[n]]}else r=this._observations.slice(e,i);return new _(r,{groups:this._groups})}bindRows(e){if(this._observations.length>0&&e.observations.length>0){const i=new Set(Object.keys(this._observations[0])),r=new Set(Object.keys(e.observations[0]));[...i].filter(t=>r.has(t)).forEach(t=>{const s=this.getVariableType(t),o=e.getVariableType(t);s!==o&&console.warn(`Warning: bindRows() is combining datasets with different data types for variable '${t}'. Left dataset has type '${s}' and right dataset has type '${o}'.`)})}return new _([...this._observations,...e.observations])}getVariableType(e){if(this._observations.length===0)return"unknown";const i={};this._observations.forEach(t=>{if(e in t){const s=t[e],o=s===null?"null":Array.isArray(s)?"array":typeof s;i[o]=(i[o]||0)+1}});let r=0,n="unknown";for(const[t,s]of Object.entries(i))s>r&&(r=s,n=t);return n}verifyObservationsContainVariable(e){if(!this._observations.every(i=>e in i))throw new g(`Variable ${e} does not exist for each item (row) in the data array.`)}variableExists(e){return this._observations.some(i=>e in i)}isNonMissingNumeric(e){return typeof e=="number"&&!isNaN(e)&&isFinite(e)}isMissingNumeric(e){return typeof e=="number"&&(isNaN(e)||!isFinite(e))||e===null||typeof e>"u"}normalizeForComparison(e){return e===null||typeof e!="object"?e:Array.isArray(e)?e.map(i=>this.normalizeForComparison(i)):Object.keys(e).sort().reduce((i,r)=>(i[r]=this.normalizeForComparison(e[r]),i),{})}deepCopy(e,i=new WeakMap){if(e===null||typeof e!="object")return e;if(i.has(e))return i.get(e);const r=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));i.set(e,r);const n=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const t of n){const s=Object.getOwnPropertyDescriptor(e,t);s&&Object.defineProperty(r,t,{...s,value:this.deepCopy(e[t],i)})}return r}hasNullJoinKeys(e,i){return i.some(r=>e[r]===null||e[r]===void 0)}}const me={coerceBooleans:!0,skipMissing:!1};function Q(m){return{...me,...m}}function pe(m,e,i){const r=Q(e);if(typeof m=="number"&&!isNaN(m)&&isFinite(m))return{value:m,isMissing:!1};if(typeof m=="boolean"&&r.coerceBooleans)return{value:m?1:0,isMissing:!1};if(m==null||typeof m=="number"&&(isNaN(m)||!isFinite(m)))return{value:0,isMissing:!0};throw new g(`${i}: has non-numeric value ${m}`)}const de=(m,e,i)=>{const r=e[0],n=Q(i);if(typeof r=="string"){if(!m.variableExists(r))return null;const t=r;m.verifyObservationsContainVariable(t);const s=[];let o=!1;if(m.observations.forEach(l=>{if(m.isNonMissingNumeric(l[t]))s.push(l[t]);else if(typeof l[t]=="boolean"&&n.coerceBooleans)s.push(l[t]?1:0);else if(m.isMissingNumeric(l[t]))o=!0;else throw new g(`median(): variable ${t} has non-numeric value ${l[t]} in this observation: ${JSON.stringify(l)}`)}),o&&!n.skipMissing||s.length===0)return null;s.sort((l,c)=>l-c);const a=Math.floor(s.length/2);return s.length%2===0?(s[a-1]+s[a])/2:s[a]}else if(Array.isArray(r)){const t=[];let s=!1;for(const a of r)if(typeof a=="number"&&!isNaN(a)&&isFinite(a))t.push(a);else if(typeof a=="boolean"&&n.coerceBooleans)t.push(a?1:0);else if(a==null||typeof a=="number"&&(isNaN(a)||!isFinite(a)))s=!0;else throw new g(`median(): has non-numeric value ${a}`);if(s&&!n.skipMissing||t.length===0)return null;t.sort((a,l)=>a-l);const o=Math.floor(t.length/2);return t.length%2===0?(t[o-1]+t[o])/2:t[o]}else{const t=pe(r,i,"median()");return t.isMissing&&!n.skipMissing||t.isMissing?null:t.value}};function j(m,e){return{summarizeFunction:de,parameters:[m],options:e}}console.log("\u26AA @m2c2kit/data-calc version 0.8.5 (d289d12c)");class he extends ae{constructor(){const e={number_of_top_pairs:{default:3,type:"integer",enum:[1,2,3,4],description:"Number of pairs to be shown on top. (1-4)"},lure_percent:{default:.5,type:"number",description:"Percentage of lure trials. Number from 0 to 1. A lure trial is when the incorrect symbol pair on the bottom contains exactly one symbol that is found on the top.(1 unique symbol). A non-lure trial is when the incorrect symbol pair contains exactly zero symbols that match the top. (2 unique symbols.)"},lure_position_on_card:{default:"either",type:"string",enum:["top","bottom","either"],description:"If a lure trial, must the lure symbol occupy the top position on the the card, the bottom, or either? If either, then the lure symbol will be equally distributed across trials to be in the top and bottom positions."},left_correct_percent:{default:.5,type:"number",description:"Percentage of trials where the left pair is the correct answer. Number from 0 to 1."},countdown_duration_ms:{default:3e3,type:"number",description:"Duration of the countdown phase, milliseconds. Multiples of 1000 recommended."},after_countdown_transition_duration_ms:{default:500,type:"number",description:"Duration, in milliseconds, of the slide in animation after the countdown phase."},number_of_trials:{default:20,type:"integer",description:"How many trials to run."},interstimulus_animation:{default:!0,type:"boolean",description:"Should new trials slide in from right to left?"},interstimulus_interval_duration_ms:{default:500,type:"number",description:"If interstimulus_animation == true, the duration, in milliseconds, of the slide in animation after each trial. Otherwise, the duration, in milliseconds, to wait after a trial has been completed until a new trial appears."},instruction_type:{default:"long",type:"string",enum:["short","long"],description:"Type of instructions to show, 'short' or 'long'."},instructions:{default:null,type:["object","null"],description:"When non-null, an InstructionsOptions object that will completely override the built-in instructions."},show_trials_complete_scene:{default:!0,type:"boolean",description:"After the final trial, should a completion scene be shown? Otherwise, the game will immediately end."},show_quit_button:{type:"boolean",default:!1,description:"Should the activity quit button be shown?"},show_fps:{type:"boolean",default:!1,description:"Should the FPS be shown?"},show_locale_picker:{type:"boolean",default:!1,description:"Should the icon that allows the participant to switch the locale be shown?"},scoring:{type:"boolean",default:!1,description:"Should scoring data be generated? Default is false."},scoring_filter_response_time_duration_ms:{type:"array",items:{type:"number"},default:[100,1e4],description:"When scoring, values of response_time_duration_ms less than the lower bound or greater than the upper bound are discarded. This array contains two numbers, the lower and upper bounds."},seed:{type:["string","null"],default:null,description:"Optional seed for the seeded pseudo-random number generator. When null, the default Math.random() is used."}},i={activity_begin_iso8601_timestamp:{type:"string",format:"date-time",description:"ISO 8601 timestamp at the beginning of the game activity."},trial_begin_iso8601_timestamp:{type:["string","null"],format:"date-time",description:"ISO 8601 timestamp at the beginning of the trial. Null if trial was skipped."},trial_end_iso8601_timestamp:{type:["string","null"],format:"date-time",description:"ISO 8601 timestamp at the end of the trial (when user selects a card). Null if trial was skipped."},trial_index:{type:["integer","null"],description:"Index of the trial within this assessment, 0-based."},trial_type:{type:["string","null"],enum:["normal","lure",null],description:"Indicates if trial was normal or lure. Null if trial was skipped."},card_configuration:{type:["object","null"],description:"Symbols used on cards. Null if trial was skipped.",properties:{top_cards_symbols:{type:"array",description:"Symbols of the top cards, starting at 0 for leftmost upper card and incrementing by 1 moving right.",items:{type:"object",properties:{top:{type:"integer",description:"Index of the top symbol within the card, 1-based."},bottom:{type:"integer",description:"Index of the bottom symbol within the card, 1-based."}}}},bottom_cards_symbols:{type:"array",description:"Symbols of the bottom cards, starting at 0 for leftmost card and incrementing by 1 moving right.",items:{type:"object",properties:{top:{type:"integer",description:"Index of the top symbol within the card, 1-based."},bottom:{type:"integer",description:"Index of the bottom symbol within the card, 1-based."}}}}}},response_time_duration_ms:{type:["number","null"],description:"Milliseconds from the beginning of the trial until a user taps a response. Null if trial was skipped."},user_response_index:{type:["integer","null"],description:"Index of user selected response, starting at 0 for leftmost card and incrementing by 1 moving right. Null if trial was skipped."},correct_response_index:{type:["integer","null"],description:"Index of correct response, starting at 0 for leftmost card and incrementing by 1 moving right. Null if trial was skipped."},quit_button_pressed:{type:"boolean",description:"Was the quit button pressed?"}},r={activity_begin_iso8601_timestamp:{type:"string",format:"date-time",description:"ISO 8601 timestamp at the beginning of the game activity."},first_trial_begin_iso8601_timestamp:{type:["string","null"],format:"date-time",description:"ISO 8601 timestamp at the beginning of the first trial. Null if no trials were completed."},last_trial_end_iso8601_timestamp:{type:["string","null"],format:"date-time",description:"ISO 8601 timestamp at the end of the last trial. Null if no trials were completed."},n_trials:{type:"integer",description:"Number of trials completed."},n_trials_lure:{type:"integer",description:"Number of lure trials completed."},n_trials_normal:{type:"integer",description:"Number of normal trials completed."},flag_trials_match_expected:{type:"integer",description:"Does the number of completed and expected trials match? 1 = true, 0 = false."},n_trials_correct:{type:"integer",description:"Number of correct trials."},n_trials_incorrect:{type:"integer",description:"Number of incorrect trials."},median_response_time_overall:{type:["number","null"],description:"Median response time for all trials."},median_response_time_filtered:{type:["number","null"],description:"Median response time for trials within the specified filter response time filter."},response_time_filter_lower_bound:{type:"number",description:"Response times less than this lower bound were discarded when calculating filtered response times."},response_time_filter_upper_bound:{type:"number",description:"Response times greater than this upper bound were discarded when calculating filtered response times."},median_response_time_correct:{type:["number","null"],description:"Median response time for correct trials."},median_response_time_incorrect:{type:["number","null"],description:"Median response time for incorrect trials."},participant_score:{type:["number","null"],description:"Participant-facing score, calculated as 10,000 / median response time for correct responses. This is a simple metric to provide feedback to the participant. Null if no correct responses."}},n={configuration:{baseLocale:"en-US"},"en-US":{localeName:"English",INSTRUCTIONS_TITLE:"Symbol Search",SHORT_INSTRUCTIONS_TEXT_PAGE_1:"Goal: Touch the set on the bottom that is exactly the same as a set above, as fast and accurately as you can",INSTRUCTIONS_TEXT_PAGE_1:"You will see sets of symbols on the top and bottom of the screen.",INSTRUCTIONS_TEXT_PAGE_2:"When prompted, touch the set on the bottom that is exactly the same as a set above.",INSTRUCTIONS_TEXT_PAGE_3:"Please be as fast and accurate as you can.",START_BUTTON_TEXT:"START",NEXT_BUTTON_TEXT:"Next",BACK_BUTTON_TEXT:"Back",GET_READY_COUNTDOWN_TEXT:"GET READY!",WHICH_MATCHES_TEXT:"Which of these matches a pair above?",OR_TEXT:"or",TRIALS_COMPLETE_SCENE_TEXT:"This activity is complete.",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"OK"},"es-MX":{localeName:"Espa\xF1ol",INSTRUCTIONS_TITLE:"B\xFAsqueda de S\xEDmbolos",INSTRUCTIONS_TEXT_PAGE_1:"Ver\xE1s series de s\xEDmbolos en la parte de arriba y abajo de la pantalla.",INSTRUCTIONS_TEXT_PAGE_2:"Cuando se le solicite, toque el grupo en la parte de abajo que es exactamente igual a un grupo de arriba.",INSTRUCTIONS_TEXT_PAGE_3:"Por favor, sea tan r\xE1pido y preciso como pueda.",START_BUTTON_TEXT:"COMENZAR",NEXT_BUTTON_TEXT:"Siguiente",BACK_BUTTON_TEXT:"Atr\xE1s",GET_READY_COUNTDOWN_TEXT:"PREP\xC1RESE",WHICH_MATCHES_TEXT:"\xBFCu\xE1l de estos coincide con un par anterior?",OR_TEXT:"o",TRIALS_COMPLETE_SCENE_TEXT:"Esta actividad est\xE1 completa.",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"OK"},"fr-FR":{localeName:"Fran\xE7ais",INSTRUCTIONS_TITLE:"Recherche de Symboles",INSTRUCTIONS_TEXT_PAGE_1:"Vous verrez des ensembles de symboles en haut et en bas de l'\xE9cran.",INSTRUCTIONS_TEXT_PAGE_2:"Lorsqu'on vous le demandera, touchez le groupe en bas qui est exactement le m\xEAme qu'un groupe ci-dessus.",INSTRUCTIONS_TEXT_PAGE_3:"Soyez aussi rapide et pr\xE9cis que possible.",START_BUTTON_TEXT:"D\xC9MARRER",NEXT_BUTTON_TEXT:"Suivant",BACK_BUTTON_TEXT:"Retour",GET_READY_COUNTDOWN_TEXT:"PR\xC9PAREZ-VOUS",WHICH_MATCHES_TEXT:"Lequel de ces \xE9l\xE9ments correspond \xE0 une paire ci-dessus ?",OR_TEXT:"ou",TRIALS_COMPLETE_SCENE_TEXT:"Cette activit\xE9 est termin\xE9e.",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"OK"},"de-DE":{localeName:"Deutsch",INSTRUCTIONS_TITLE:"Symbol-\xDCbereinstimmungs",INSTRUCTIONS_TEXT_PAGE_1:"Oben und unten sehen Sie Symbolpaare.",INSTRUCTIONS_TEXT_PAGE_2:"Ihre Aufgabe wird es sein, auf dasjenige untere Paar zu tippen, welches mit einem der obigen Paare exakt \xFCbereinstimmt.",INSTRUCTIONS_TEXT_PAGE_3:"Versuchen Sie bitte, so schnell und korrekt wie m\xF6glich zu sein.",START_BUTTON_TEXT:"START",NEXT_BUTTON_TEXT:"Weiter",BACK_BUTTON_TEXT:"Vorherige",GET_READY_COUNTDOWN_TEXT:"BEREIT MACHEN",WHICH_MATCHES_TEXT:"Welches dieser beiden stimmt mit einem der obigen Paare \xFCberein?",OR_TEXT:"oder",TRIALS_COMPLETE_SCENE_TEXT:"Die Aufgabe ist beendet.",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"OK"},"it-IT":{localeName:"Italiano",INSTRUCTIONS_TITLE:"Ricerca di simboli",SHORT_INSTRUCTIONS_TEXT_PAGE_1:"Obiettivo: Tocca il pi\xF9 velocemente e accuratamente possibile il gruppo in basso che \xE8 esattamente uguale al gruppo in alto.",INSTRUCTIONS_TEXT_PAGE_1:"Vedrai gruppi di simboli nella parte alta e nella parte bassa del tuo schermo.",INSTRUCTIONS_TEXT_PAGE_2:"Quando richiesto, tocca il gruppo in basso che \xE8 esattamente uguale al gruppo in alto.",INSTRUCTIONS_TEXT_PAGE_3:"Per favore, cerca di essere il pi\xF9 veloce ed accurato possibile.",START_BUTTON_TEXT:"INIZIA",NEXT_BUTTON_TEXT:"Avanti",BACK_BUTTON_TEXT:"Indietro",GET_READY_COUNTDOWN_TEXT:"PREPARATI!",WHICH_MATCHES_TEXT:"Quali di questi corrisponde al gruppo in alto?",OR_TEXT:"o",TRIALS_COMPLETE_SCENE_TEXT:"Attivit\xE0 completata.",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"OK"},"jp-JP":{localeName:"Japanese",localeSvg:{svgString:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 396.43 133.77"><path d="M0 9.22h93.45v121.25H83.37v-8.64H9.94v9.5H0zm83.37 9.79H9.94v41.33h73.44V19.01ZM9.94 112.03h73.44V69.84H9.94zM247.82 40.9h-52.56c12.38 25.63 33.98 49.39 57.46 60.62-2.45 2.02-5.62 5.76-7.34 8.5-22.61-12.24-43.06-35.28-56.3-61.34v47.23h28.8v9.79h-28.8v27.94H179V105.7h-29.23v-9.79H179V48.97c-13.68 26.06-34.27 48.67-56.02 61.34-1.73-2.45-4.75-6.05-6.91-7.92 22.61-11.66 44.21-35.85 56.74-61.49h-51.98v-9.79h58.18V0l12.96.72c-.14 1.01-.86 1.73-2.88 2.02v28.37h58.75v9.79Zm13.25-8.21v-8.21h52.85v8.21zm48.24 51.69v42.34h-33.12v6.77h-8.5v-49.1h41.62Zm-.43-39.74v7.92h-41.04v-7.92zm-41.04 27.79v-7.92h41.04v7.92zm40.61-67.39v7.92h-39.74V5.04zm-7.78 87.55h-24.48v25.92h24.48zm81.36-31.97h14.4v8.78h-82.08v-8.78h19.73c1.3-6.34 2.74-13.82 4.18-21.74h-15.84v-8.64h17.28c.86-5.47 1.73-11.09 2.59-16.13h-22.75V5.47h71.57v8.64h-39.46l-2.45 16.13h32.83zm-56.3 73.15V81.35h60.62v51.55h-9.36v-5.76h-42.05v6.62h-9.22Zm51.26-43.63h-42.05v28.08h42.05zm-4.32-51.26h-24.91c-1.3 7.78-2.74 15.41-4.03 21.74h28.94z"/></svg>',width:65,height:22},fontName:"noto-sans-japanese",INSTRUCTIONS_TITLE:"\u8A18\u53F7\u63A2\u3057",INSTRUCTIONS_TEXT_PAGE_1:"\u753B\u9762\u306E\u4E0A\u90E8\u3068\u4E0B\u90E8\u306B\u8A18\u53F7\u306E\u30DA\u30A2\u304C\u8868\u793A\u3055\u308C\u307E\u3059\u3002",INSTRUCTIONS_TEXT_PAGE_2:"\u6307\u793A\u304C\u3042\u3063\u305F\u3089\u3001\u4E0A\u306B\u8868\u793A\u3055\u308C\u3066\u3044\u308B\u30DA\u30A2\u3068\u307E\u3063\u305F\u304F\u540C\u3058\u30DA\u30A2\u3092\u4E0B\u304B\u3089\u9078\u3093\u3067\u30BF\u30C3\u30C1\u3057\u3066\u304F\u3060\u3055\u3044\u3002",INSTRUCTIONS_TEXT_PAGE_3:"\u3067\u304D\u308B\u3060\u3051\u901F\u304F\u3001\u305D\u3057\u3066\u6B63\u78BA\u306B\u884C\u3063\u3066\u304F\u3060\u3055\u3044\u3002",START_BUTTON_TEXT:"\u30B9\u30BF\u30FC\u30C8",NEXT_BUTTON_TEXT:"\u6B21\u3078",BACK_BUTTON_TEXT:"\u623B\u308B",GET_READY_COUNTDOWN_TEXT:{text:"\u6E96\u5099\u3057\u3066\u304F\u3060\u3055\u3044\uFF01",fontSize:40},WHICH_MATCHES_TEXT:"\u3069\u308C\u304C\u4E0A\u306E\u30DA\u30A2\u3068\u4E00\u81F4\u3057\u307E\u3059\u304B\uFF1F",OR_TEXT:"\u307E\u305F\u306F",TRIALS_COMPLETE_SCENE_TEXT:"\u3053\u306E\u30C6\u30B9\u30C8\u306F\u5B8C\u4E86\u3057\u307E\u3057\u305F\u3002",TRIALS_COMPLETE_SCENE_BUTTON_TEXT:"\u7D42\u4E86"}},t=160,s={name:"Symbol Search",id:"symbol-search",publishUuid:"400ad833-3037-4738-8ad8-c54e07c46896",version:"0.8.32 (d289d12c)",moduleMetadata:{name:"@m2c2kit/assessment-symbol-search",version:"0.8.32",dependencies:{"@m2c2kit/addons":"0.3.33","@m2c2kit/core":"0.3.34","@m2c2kit/data-calc":"0.8.5"}},translation:n,shortDescription:"Symbol Search is a speeded continuous performance test of conjunctive feature search in which respondents identify matching symbol pairs as quickly and as accurately as they can.",longDescription:'On each trial of the symbol search task, participants saw a row of three symbol pairs at the top of the screen and were presented with two symbol pairs at the bottom of the screen. Stimuli were presented until a response was provided there was an interval of 200 msec. between each response and the following stimulus. Participants decided, as quickly as possible, which of the two pairs presented at the bottom of the screen was among the pairs at the top of the screen (see Figure 1). Participants completed 12 trials of this task. The dependent variable was median response time of correct trials. Because this task requires speeded comparisons similar to standard laboratory tests, we reasoned it would be a viable indicator of perceptual speed. SOURCE: Sliwinski, Martin J., Jacqueline A. Mogle, Jinshil Hyun, Elizabeth Munoz, Joshua M. Smyth, and Richard B. Lipton. "Reliability and validity of ambulatory cognitive assessments." Assessment 25, no. 1 (2018): 14-30.',showFps:e.show_fps.default,width:400,height:800,trialSchema:i,scoringSchema:r,parameters:e,fonts:[{fontName:"roboto",url:"fonts/roboto/Roboto-Regular.ttf"},{fontName:"noto-sans-japanese",url:"fonts/noto-sans-japanese/NotoSansJP-Regular.ttf",lazy:!0}],bodyBackgroundColor:b.White,images:[{imageName:"gameImage",height:340,width:255,url:"images/gameImage.png",localize:!0},{imageName:"gameImageOutlinedCards",height:340,width:255,url:"images/gameImageOutlinedCards.png",localize:!0},{imageName:"stopwatchImage",height:319,width:256,url:"images/stopwatch.svg"},{imageName:"ssintroImage",height:186,width:336,url:"images/ssintroImage.png"},{imageName:"ss-01",height:t,width:t,url:"images/ss-01.svg"},{imageName:"ss-02",height:t,width:t,url:"images/ss-02.svg"},{imageName:"ss-03",height:t,width:t,url:"images/ss-03.svg"},{imageName:"ss-04",height:t,width:t,url:"images/ss-04.svg"},{imageName:"ss-05",height:t,width:t,url:"images/ss-05.svg"},{imageName:"ss-06",height:t,width:t,url:"images/ss-06.svg"},{imageName:"ss-07",height:t,width:t,url:"images/ss-07.svg"},{imageName:"ss-08",height:t,width:t,url:"images/ss-08.svg"},{imageName:"ss-09",height:t,width:t,url:"images/ss-09.svg"},{imageName:"ss-10",height:t,width:t,url:"images/ss-10.svg"},{imageName:"ss-11",height:t,width:t,url:"images/ss-11.svg"},{imageName:"ss-12",height:t,width:t,url:"images/ss-12.svg"},{imageName:"ss-13",height:t,width:t,url:"images/ss-13.svg"},{imageName:"ss-14",height:t,width:t,url:"images/ss-14.svg"},{imageName:"ss-15",height:t,width:t,url:"images/ss-15.svg"},{imageName:"ss-16",height:t,width:t,url:"images/ss-16.svg"},{imageName:"ss-17",height:t,width:t,url:"images/ss-17.svg"},{imageName:"ss-18",height:t,width:t,url:"images/ss-18.svg"},{imageName:"ss-19",height:t,width:t,url:"images/ss-19.svg"},{imageName:"ss-20",height:t,width:t,url:"images/ss-20.svg"},{imageName:"ss-21",height:t,width:t,url:"images/ss-21.svg"},{imageName:"ss-22",height:t,width:t,url:"images/ss-22.svg"},{imageName:"ss-23",height:t,width:t,url:"images/ss-23.svg"},{imageName:"ss-24",height:t,width:t,url:"images/ss-24.svg"},{imageName:"circle-x",height:32,width:32,url:"images/circle-x.svg"}]};super(s)}async initialize(){await super.initialize();const e=this,i=e.getParameter("seed");typeof i=="string"&&v.setSeed(i);const r=24;if(e.getParameter("show_quit_button")){const p=new D({imageName:"circle-x",position:{x:380,y:20},isUserInteractionEnabled:!0});e.addFreeNode(p),p.onTapDown(E=>{e.removeAllFreeNodes(),E.handled=!0;const O=new W;if(e.addScene(O),e.presentScene(O),e.addTrialData("quit_button_pressed",!0),e.trialComplete(),e.getParameter("scoring")){const T=e.calculateScores([],{rtLowerBound:e.getParameter("scoring_filter_response_time_duration_ms")[0],rtUpperBound:e.getParameter("scoring_filter_response_time_duration_ms")[1],numberOfTrials:e.getParameter("number_of_trials")});e.addScoringData(T),e.scoringComplete()}e.cancel()})}let n;e.getParameter("show_locale_picker")&&(n=new le,e.addFreeNode(n));let t;const s=e.getParameter("instructions");if(s)t=K.create(s);else{const p={backgroundColor:b.White,nextButtonBackgroundColor:b.Black,backButtonBackgroundColor:b.Black,nextSceneTransition:J.slide({direction:H.Left,duration:500,easing:G.sinusoidalInOut}),backSceneTransition:J.slide({direction:H.Right,duration:500,easing:G.sinusoidalInOut})};switch(e.getParameter("instruction_type")){case"short":{t=K.create({...p,instructionScenes:[{title:"INSTRUCTIONS_TITLE",text:"SHORT_INSTRUCTIONS_TEXT_PAGE_1",imageName:"ssintroImage",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"START_BUTTON_TEXT",nextButtonBackgroundColor:b.Green}]});break}case"long":{t=K.create({...p,instructionScenes:[{title:"INSTRUCTIONS_TITLE",text:"INSTRUCTIONS_TEXT_PAGE_1",imageName:"gameImage",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"NEXT_BUTTON_TEXT"},{title:"INSTRUCTIONS_TITLE",text:"INSTRUCTIONS_TEXT_PAGE_2",imageName:"gameImageOutlinedCards",imageAboveText:!1,imageMarginTop:12,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"NEXT_BUTTON_TEXT",backButtonText:"BACK_BUTTON_TEXT"},{title:"INSTRUCTIONS_TITLE",text:"INSTRUCTIONS_TEXT_PAGE_3",imageName:"stopwatchImage",imageAboveText:!1,imageMarginTop:48,textFontSize:24,titleFontSize:30,textVerticalBias:.25,nextButtonText:"START_BUTTON_TEXT",nextButtonBackgroundColor:b.Green,backButtonText:"BACK_BUTTON_TEXT"}]});break}default:throw new F(`invalid value for instruction_type: ${e.getParameter("instruction_type")}`)}}t[0].onAppear(()=>{e.addTrialData("activity_begin_iso8601_timestamp",this.beginIso8601Timestamp)}),e.addScenes(t);const o=J.slide({direction:H.Left,duration:e.getParameter("interstimulus_interval_duration_ms"),easing:G.sinusoidalInOut}),a=new ue({milliseconds:e.getParameter("countdown_duration_ms"),text:"GET_READY_COUNTDOWN_TEXT",transitionDurationMilliseconds:e.getParameter("after_countdown_transition_duration_ms")});e.addScene(a),a.onSetup(()=>{n&&(n.hidden=!0)});const l=new W({name:"chooseCardScene",backgroundColor:[169,201,219,1]});e.addScene(l);const c=new Z({rect:{size:{width:400,height:400}},fillColor:[166,177,181,1],position:{x:200,y:600}});l.addChild(c);const d=new L({text:"WHICH_MATCHES_TEXT",fontSize:22,preferredMaxLayoutWidth:240});l.addChild(d),d.position={x:200,y:460};const h=new L({text:"OR_TEXT",fontSize:22,preferredMaxLayoutWidth:240});l.addChild(h),h.position={x:200,y:580};const B=[],P=e.getParameter("number_of_trials"),ee=e.getParameter("lure_percent"),te=e.getParameter("left_correct_percent"),N=e.getParameter("number_of_top_pairs"),U=Math.round(P*ee),ie=Math.round(P*te),se=v.fromRangeWithoutReplacement(U,0,P-1),re=v.fromRangeWithoutReplacement(ie,0,P-1);let I;switch(e.getParameter("lure_position_on_card")){case"top":{I=Array(U).fill(0);break}case"bottom":{I=Array(U).fill(1);break}case"either":{const p=Math.round(U/2);I=[...Array(p).fill(0),...Array(U-p).fill(1)],I=this.shuffleArray(I);break}default:throw new F(`invalid value for lure_position_on_card: ${e.getParameter("lure_position_on_card")}`)}for(let p=0;p<P;p++){const E=se.includes(p),O=re.includes(p);let T;E?T=v.fromRangeWithoutReplacement(N*2+1,1,r):T=v.fromRangeWithoutReplacement(N*2+2,1,r);const y=new Array;for(let w=0;w<N;w++){const M={top:T[2*w],bottom:T[2*w+1]};y.push(M)}const X=v.fromRangeWithoutReplacement(1,0,N-1)[0],x=y[X];let C;if(!E)C={top:T[2*N],bottom:T[2*N+1]};else{const w=y.filter(S=>S!=x).map(S=>[S.top,S.bottom]).flat(),M=v.fromRangeWithoutReplacement(1,0,w.length-1)[0],u=w[M],f=I.shift();if(f===void 0)throw new F("lurePositions is empty");f===0?C={top:u,bottom:T[2*N]}:C={top:T[2*N],bottom:u}}const R={top_cards_symbols:y,bottom_cards_symbols:O?[x,C]:[C,x],trial_type:E?"lure":"normal",correct_response_index:O?0:1};B.push(R)}l.onSetup(()=>{h.hidden=!1;const p=B[e.trialIndex],E=p.top_cards_symbols.length,O=p.bottom_cards_symbols.length;let T;switch(E){case 2:case 4:{T=200;break}case 3:{T=100;break}default:throw new F("valid values for number_of_top_pairs are 2, 3, or 4 cards")}let y;if(E>=1&&E<=3)y=new $({rows:1,columns:E,size:{width:80*E+T,height:160},position:{x:200,y:200},backgroundColor:b.Transparent,gridLineColor:b.Transparent});else if(E===4)y=new $({rows:2,columns:2,size:{width:160+T,height:200+T},position:{x:200,y:200},backgroundColor:b.Transparent,gridLineColor:b.Transparent});else throw new F("invalid number_of_top_pairs");l.addChild(y);const X=new $({rows:1,columns:2,size:{width:360,height:160},position:{x:200,y:600},backgroundColor:b.Transparent,gridLineColor:b.Transparent});l.addChild(X);function x(u,f){const S=new Z({rect:{size:{width:80,height:160}},fillColor:b.White,strokeColor:b.Black,lineWidth:2}),Y=new D({imageName:"ss-"+u.toString().padStart(2,"0"),position:{x:0,y:-36}});S.addChild(Y);const V=new D({imageName:"ss-"+f.toString().padStart(2,"0"),position:{x:0,y:36}});return S.addChild(V),S}const C=new Array;for(let u=0;u<E;u++){const f=x(p.top_cards_symbols[u].top,p.top_cards_symbols[u].bottom);C.push(f),E===4?y.addAtCell(f,Math.floor(u/2),u%2):y.addAtCell(f,0,u)}const R=new Array;for(let u=0;u<O;u++){const f=x(p.bottom_cards_symbols[u].top,p.bottom_cards_symbols[u].bottom);f.userData={index:u},R.push(f),X.addAtCell(f,0,u)}function w(u){u?R.forEach(f=>f.isUserInteractionEnabled=!0):R.forEach(f=>f.isUserInteractionEnabled=!1)}R.forEach(u=>u.onTapDown(()=>M(u)));function M(u){X.hidden=!0,y.hidden=!0,h.hidden=!0,z.stop("rt"),w(!1);const f=z.elapsed("rt");z.remove("rt"),e.addTrialData("trial_end_iso8601_timestamp",new Date().toISOString()),e.addTrialData("trial_type",p.trial_type),e.addTrialData("response_time_duration_ms",f),e.addTrialData("correct_response_index",p.correct_response_index),e.addTrialData("user_response_index",u.userData.index);const{correct_response_index:S,trial_type:Y,...V}=p;if(e.addTrialData("card_configuration",V),e.addTrialData("quit_button_pressed",!1),e.addTrialData("trial_index",e.trialIndex),e.trialComplete(),e.trialIndex<e.getParameter("number_of_trials"))h.hidden=!0,e.getParameter("interstimulus_animation")?e.presentScene(l,o):l.run(q.sequence([q.wait({duration:e.getParameter("interstimulus_interval_ms")}),q.custom({callback:()=>{e.presentScene(l)}})]));else{if(e.getParameter("scoring")){const oe=e.calculateScores(e.data.trials,{rtLowerBound:e.getParameter("scoring_filter_response_time_duration_ms")[0],rtUpperBound:e.getParameter("scoring_filter_response_time_duration_ms")[1],numberOfTrials:e.getParameter("number_of_trials")});e.addScoringData(oe),e.scoringComplete()}d.hidden=!1,e.removeFreeNode("questionLabelFree"),e.getParameter("show_trials_complete_scene")?e.presentScene(A,o):e.end()}}l.onAppear(()=>{if(e.addTrialData("activity_begin_iso8601_timestamp",this.beginIso8601Timestamp),e.addTrialData("trial_begin_iso8601_timestamp",new Date().toISOString()),!e.nodes.map(u=>u.name).includes("questionLabelFree")){d.hidden=!0;const u=new L({name:"questionLabelFree",text:"WHICH_MATCHES_TEXT",fontSize:22,preferredMaxLayoutWidth:240});e.addFreeNode(u),u.position={x:200,y:460}}w(!0),z.startNew("rt")},{replaceExisting:!0})});const A=new W;e.addScene(A);const ne=new L({text:"TRIALS_COMPLETE_SCENE_TEXT",position:{x:200,y:400}});A.addChild(ne);const k=new ce({text:"TRIALS_COMPLETE_SCENE_BUTTON_TEXT",position:{x:200,y:600},backgroundColor:b.Black});k.isUserInteractionEnabled=!0,k.onTapDown(()=>{k.isUserInteractionEnabled=!1,A.removeAllChildren(),e.end()}),A.addChild(k),A.onSetup(()=>{e.removeAllFreeNodes()})}calculateScores(e,i){const r=new _(e);return r.summarize({activity_begin_iso8601_timestamp:this.beginIso8601Timestamp,first_trial_begin_iso8601_timestamp:r.arrange("trial_begin_iso8601_timestamp").slice(0).pull("trial_begin_iso8601_timestamp"),last_trial_end_iso8601_timestamp:r.arrange("-trial_end_iso8601_timestamp").slice(0).pull("trial_end_iso8601_timestamp"),n_trials:r.length,flag_trials_match_expected:r.length===i.numberOfTrials?1:0,n_trials_lure:r.filter(t=>t.trial_type==="lure").length,n_trials_normal:r.filter(t=>t.trial_type==="normal").length,n_trials_correct:r.filter(t=>t.user_response_index===t.correct_response_index).length,n_trials_incorrect:r.filter(t=>t.user_response_index!==t.correct_response_index).length,median_response_time_overall:j("response_time_duration_ms"),median_response_time_filtered:j(r.filter(t=>t.response_time_duration_ms>=i.rtLowerBound&&t.response_time_duration_ms<=i.rtUpperBound).pull("response_time_duration_ms")),median_response_time_correct:j(r.filter(t=>t.user_response_index===t.correct_response_index).pull("response_time_duration_ms")),median_response_time_incorrect:j(r.filter(t=>t.user_response_index!==t.correct_response_index).pull("response_time_duration_ms")),response_time_filter_lower_bound:i.rtLowerBound,response_time_filter_upper_bound:i.rtUpperBound}).mutate({participant_score:t=>t.median_response_time_correct===null?null:1e4/t.median_response_time_correct}).observations}shuffleArray(e){const i=[...e],r=[];for(;i.length>0;){const n=v.singleFromRange(0,i.length-1);r.push(i.splice(n,1)[0])}return r}}export{he as SymbolSearch};
